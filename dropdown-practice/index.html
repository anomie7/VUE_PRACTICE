<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Welcome to Vue</title>
    <script src="https://unpkg.com/vue"></script>
    <link rel="stylesheet" href=".\front_20180706.css">
    <link href="./bootstrap/basic/css/bootstrap.min.css" rel="stylesheet">
    <link href="./bootstrap/basic/font-awesome/css/font-awesome.css" rel="stylesheet: ">
</head>
<template id="dropdown-template">
    <div class="dropdown">
        <div :class="{'disabled-dropdown':!titleShow, 'dropdown-title': titleShow}" @click="dropdownShow">
            <label class="title-label">{{titleMessage}}</label>
        </div>
        <div class="dropdown-scroll-hider" v-show="isDropdownShow" style="display: block; transform: translateY(0px);">
            <div class="dropdown-container" style="display: block;">
                <div class="text-label-container" :data-val="labelText.TICKET_MONTH_LIST" @click="chooseTextLabel(index, $event)" v-for="(labelText, index) in labelTextList"
                    :key="labelText.TICKET_MONTH_LIST">
                    <label class="dateTicket-text-label">
                        {{labelText.YEAR}}년 {{labelText.MONTH}}월
                    </label>
                </div>
            </div>
        </div>
    </div>
</template>

<body>
    <div id="app">
        <div @click="showTicketPopup">구매하기</div>
        <div id="popup-date-ticket" class="popup" :class="classObject" @click.self="closeTicketPopup">
            <div id="dateticket-scroll-hider">
                <div class="bar-button-left btn-ticket-close" @click="closeTicketPopup">
                    <img src="./images/front/ic_cancel_square_dark.svg" />
                </div>
                <div class="ticket-text-container">
                    티켓 선택
                </div>
                <div class="total-wrapper">
                    선택한 총 티켓금액 &nbsp;&nbsp;
                    <span class="total-won">원</span>
                    <div class="total-price">0</div>
                </div>
                <div class="ticket-horizontal-line">
                </div>
                <div class="ticket-wrapper">
                    <form action="/orderPayments" method="post" id="date-ticket-form">
                        <input type="hidden" id="date-popup-item-id" name="item_id" value="" />
                        <div class="dateticket-list" style="display: none;"></div>
                        <div id="selector-container">
                            <dropdown-template :title-message="monthTitle" :title-show="true" :label-text-list="labelTextList" @choose="chooseDropdownLabel"></dropdown-template>
                            <dropdown-template title-message="날짜를 선택하세요."></dropdown-template>
                            <dropdown-template title-message="관람시간을 선택하세요."></dropdown-template>
                            <dropdown-template title-message="옵션을 선택하세요."></dropdown-template>
                        </div>
                    </form>
                </div>
                <div class="buttons">
                    <button type="button" id="date-ticket-submit" class="btn-max-blue" onclick="ticketSaleSubmit('#date-ticket-form');">구매하기</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        Vue.component('dropdown-template', {
            template: '#dropdown-template',
            data: function () {
                return {
                    isDropdownShow: false
                }
            },
            props: {
                'titleMessage': {
                    type: String,
                    required: true
                },
                'titleShow': {
                    type: Boolean,
                    default: function () {
                        return false;
                    }
                },
                'labelTextList': Array
            },
            methods: {
                dropdownShow(e) {
                    if (e.currentTarget.className == 'dropdown-title') {
                        this.isDropdownShow = !this.isDropdownShow;
                    }
                },
                chooseTextLabel(i, e) {
                    this.isDropdownShow = false;
                    this.$emit('choose', this.labelTextList[i]);
                }
            }
        });

        var app = new Vue({
            el: '#app',
            data: {
                monthTitle: "월을 입력하세요.",
                monthTitleShow: true,
                classObject: {
                    'show-ticket': false
                },
                labelTextList: [
                    { "MONTH": 7, "YEAR": "2018", "TICKET_MONTH_LIST": "2018-07" }, 
                    { "MONTH": 8, "YEAR": "2018", "TICKET_MONTH_LIST": "2018-08" }, 
                    { "MONTH": 9, "YEAR": "2018", "TICKET_MONTH_LIST": "2018-09" },
                    { "MONTH": 10, "YEAR": "2018", "TICKET_MONTH_LIST": "2018-10" }, 
                    { "MONTH": 11, "YEAR": "2018", "TICKET_MONTH_LIST": "2018-11" }
                    ]
            },
            methods: {
                showTicketPopup() {
                    this.classObject['show-ticket'] = true;
                },
                closeTicketPopup() {
                    this.classObject['show-ticket'] = false;
                },
                chooseDropdownLabel(labelText){
                    this.monthTitle = `${labelText.YEAR}년 ${labelText.MONTH}월`;
                }
            }
        })
    </script>
</body>

</html>